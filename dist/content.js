(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}var t=document.createElement("style");t.textContent="\n    @keyframes shake {\n        0%, 100% { transform: translateX(0); }\n        25% { transform: translateX(-5px); }\n        75% { transform: translateX(5px); }\n    }\n",document.head.appendChild(t);var n,o,r,i,c=(n=function(e){window.postMessage({type:"GET_COMMENTS",tweetId:e},"*")},function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];clearTimeout(o),o=setTimeout((function(){clearTimeout(o),n.apply(void 0,t)}),1e3)});function a(){var e=document.createElement("div");e.className="custom-container";var t=function(){var e=document.createElement("div");return e.id="helloTextBox",e.style.cssText='\n        padding: 10px;\n        margin: 10px 0;\n        border: 1px solid #333;\n        border-radius: 8px;\n        background-color: #000;\n        color: #71767b;\n        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;\n        min-height: 20px;\n    ',e.textContent="Write your anonymous comment...",e.contentEditable="true",e.addEventListener("focus",(function(){"Write your anonymous comment..."===this.textContent&&(this.textContent="",this.style.color="#fff")})),e.addEventListener("blur",(function(){""===this.textContent.trim()&&(this.textContent="Write your anonymous comment...",this.style.color="#71767b")})),e}(),n=function(){var e,t=document.createElement("div");return t.style.cssText="\n        display: flex;\n        gap: 10px;\n    ",t.appendChild(((e=document.createElement("button")).id="wallet-connect-button",e.style.cssText='\n        padding: 8px 16px;\n        margin: 10px 0;\n        border: none;\n        border-radius: 20px;\n        background-color: #1DA1F2;\n        color: white;\n        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;\n        font-weight: bold;\n        cursor: pointer;\n        transition: background-color 0.2s;\n        margin-right: 10px;\n        min-width: 140px;\n    ',e.textContent="Connect Wallet",e.onmouseover=function(){return e.style.backgroundColor="#1991db"},e.onmouseout=function(){return e.style.backgroundColor="#1DA1F2"},e.onclick=function(){window.postMessage({type:"CONNECT_ARWEAVE"},"*")},e)),t.appendChild(function(){var e=document.createElement("button");return e.style.cssText='\n        padding: 8px 16px;\n        margin: 10px 0;\n        border: none;\n        border-radius: 20px;\n        background-color: #28a745;\n        color: white;\n        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;\n        font-weight: bold;\n        cursor: pointer;\n        transition: background-color 0.2s;\n    ',e.textContent="Anonymous comment",e.onmouseover=function(){return e.style.backgroundColor="#218838"},e.onmouseout=function(){return e.style.backgroundColor="#28a745"},e.onclick=function(){var e=document.getElementById("helloTextBox"),t=e?e.textContent:"";if(!t||""===t.trim()||"Write your anonymous comment..."===t)return e.style.animation="shake 0.5s",setTimeout((function(){e.style.animation=""}),500),e.style.border="1px solid #dc3545",void setTimeout((function(){e.style.border="1px solid #333"}),2e3);var n=window.location.href.split("/").pop();window.postMessage({type:"SEND_TEXT",text:t.trim(),tweetId:n},"*"),e.textContent="Write your anonymous comment...",e.style.color="#71767b"},e}()),t}();e.appendChild(t),e.appendChild(n);var o=window.location.href.split("/").pop();return c(o),e}function s(){var e=document.querySelector('[data-testid="inline_reply_offscreen"]');if(e&&!document.querySelector(".custom-container")){var t=a();e.parentNode.insertBefore(t,e.nextSibling)}}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4;return new Promise((function(n,o){if(document.querySelector(e))return n(document.querySelector(e));var r=new MutationObserver((function(){document.querySelector(e)&&(r.disconnect(),n(document.querySelector(e)))}));r.observe(document.body,{childList:!0,subtree:!0}),setTimeout((function(){r.disconnect(),o("Timeout waiting for element")}),t)}))}(r=document.createElement("script")).src=chrome.runtime.getURL("inject.js"),r.type="text/javascript",(document.head||document.documentElement).appendChild(r),window.addEventListener("message",(function(e){"CONNECT_ARWEAVE"===e.data.type&&window.postMessage({type:"TRIGGER_ARCONNECT"},"*")})),window.addEventListener("message",(function(e){"SEND_HELLO"===e.data.type&&window.postMessage({type:"SEND_HELLO_AO"},"*")})),document.addEventListener("COMMENTS_IN_TWITTER",(function(t){var n=t.detail.comments;console.log("Received comments:",n),console.log("comments type:",e(n));var o=JSON.parse(n);if(o&&Array.isArray(o)){o.sort((function(e,t){var n=new Date(e.time).getTime();return new Date(t.time).getTime()-n})),console.log("Creating comment section");var r=document.querySelector(".custom-container");if(r){var i=r.querySelector(".comment-section");i&&i.remove();var c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=document.createElement("div");if(t.className="comment-section",t.style.cssText="\n        margin-top: 16px;\n        border: 1px solid #2f3336;\n        border-radius: 16px;\n        overflow: hidden;\n    ",0===e.length){var n=document.createElement("div");return n.style.cssText="\n            padding: 20px;\n            text-align: center;\n            color: #71767b;\n        ",n.textContent="No comments yet",t.appendChild(n),t}return e.forEach((function(e){var n=function(e){var t=document.createElement("div");t.style.cssText="\n        padding: 12px;\n        border-bottom: 1px solid #2f3336;\n        background-color: black;\n        color: white;\n    ";var n=document.createElement("div");n.style.cssText="\n        display: flex;\n        gap: 12px;\n    ";var o=document.createElement("div");o.style.cssText="\n        width: 40px;\n        height: 40px;\n        border-radius: 50%;\n        background-color: #1c1c1c;\n        flex-shrink: 0;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        overflow: hidden;\n    ",o.innerHTML='\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <path d="M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V20H20V18C20 15.34 14.67 14 12 14Z" \n                  fill="#4A4A4A"/>\n        </svg>\n    ';var r=document.createElement("div");r.style.cssText="\n        flex-grow: 1;\n    ";var i,c=document.createElement("span");c.style.cssText="\n        font-weight: bold;\n        margin-right: 8px;\n    ",c.textContent=(i=e.username)&&"Anonymous"!==i?i.length<=10?i:"".concat(i.slice(0,6),"...").concat(i.slice(-4)):"Anonymous";var a=document.createElement("span");a.style.cssText="\n        color: #71767b;\n        font-size: 14px;\n        margin-left: 8px;\n    ",a.textContent=function(e){if(!e)return"Just now";var t=new Date(e);if(isNaN(t.getTime()))return"Invalid date";var n=new Date;if(Math.floor((n-t)/6e4)<60)return"Just now";var o=function(e){return String(e).padStart(2,"0")},r=t.getFullYear(),i=o(t.getMonth()+1),c=o(t.getDate()),a=o(t.getHours()),s=o(t.getMinutes());return"".concat(r,"/").concat(i,"/").concat(c," ").concat(a,":").concat(s)}(e.time);var s=document.createElement("div");return s.style.cssText="\n        margin-top: 4px;\n        line-height: 1.3;\n    ",s.textContent=e.text,r.appendChild(c),r.appendChild(a),r.appendChild(s),n.appendChild(o),n.appendChild(r),t.appendChild(n),t}({username:e.owner||"Anonymous",time:e.time||"Just now",text:e.message||""});t.appendChild(n)})),t}(o);r.appendChild(c)}}})),document.addEventListener("ARCONNECT_SUCCESS",(function(e){var t=e.detail.address,n="".concat(t.slice(0,6),"...").concat(t.slice(-4)),o=document.getElementById("wallet-connect-button");o&&(o.textContent=n,o.style.backgroundColor="#28a745",o.onmouseover=function(){return o.style.backgroundColor="#218838"},o.onmouseout=function(){return o.style.backgroundColor="#28a745"})})),document.addEventListener("ARCONNECT_ERROR",(function(e){alert("Connection failed: ".concat(e.detail.error))})),document.addEventListener("COMMENT_CREATED",(function(e){console.log("Comment created:",e.detail),c(e.detail.tweetId)})),i=location.href,new MutationObserver((function(){var e=location.href;if(e!==i){i=e,console.log("URL changed to:",e);var t=document.querySelector(".custom-container");t&&t.remove(),l('[data-testid="inline_reply_offscreen"]').then((function(){s()})).catch((function(){console.log("Target element not found after timeout")}))}})).observe(document.body,{subtree:!0,childList:!0}),l('[data-testid="inline_reply_offscreen"]').then((function(){s()})).catch((function(){console.log("Target element not found after timeout")}))})();